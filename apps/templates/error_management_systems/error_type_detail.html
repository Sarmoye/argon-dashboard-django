{% extends 'layouts/base.html' %}

{% load static %}

{% block content %}
  <div class="container">
    <h1 class="mb-4">Détails du Type d'Erreur</h1>

    <div class="card p-3 mb-4">
      <p><strong>ID:</strong> {{ error_type.id }}</p>
      <p><strong>Système:</strong> {{ error_type.system_name }}</p>
      <p><strong>Service:</strong> {{ error_type.service_name }}</p>
      <p><strong>Raison de l'Erreur:</strong> {{ error_type.error_reason }}</p>
      <p><strong>Code Erreur:</strong> {{ error_type.code_erreur }}</p>
      <p><strong>Fichiers Impactés:</strong> {{ error_type.fichiers_impactes }}</p>
      <p><strong>Logs:</strong> {{ error_type.logs }}</p>
      <p><strong>Description Technique:</strong> {{ error_type.description_technique }}</p>
      <p><strong>Comportement Attendu:</strong> {{ error_type.comportement_attendu }}</p>
      <p><strong>Procédures de Contournement:</strong> {{ error_type.procedures_contournement }}</p>
      <p><strong>Environnement:</strong> {{ error_type.environnement }}</p>
      <p><strong>Niveau de Sévérité:</strong> {{ error_type.niveau_severite }}</p>
    </div>

    <h2 class="mb-3">Événements Associés</h2>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>ID</th>
          <th>Timestamp</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for event in events %}
          <tr>
            <td>{{ event.id }}</td>
            <td>{{ event.timestamp }}</td>
            <td><a href="{% url 'error_management_systems:event_detail' event.id %}" class="btn btn-primary btn-sm">Détails</a></td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="3" class="text-center">Aucun événement associé trouvé.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    {% if has_ticket %}
      <h2 class="mt-4">Ticket Associé</h2>
      <a href="{% url 'error_management_systems:ticket_detail' ticket.id %}" class="btn btn-info">Voir le ticket associé ({{ ticket.ticket_reference }})</a>
    {% else %}
      <p class="mt-3">Aucun ticket associé à ce type d'erreur.</p>
    {% endif %}
  </div>
{% endblock %}